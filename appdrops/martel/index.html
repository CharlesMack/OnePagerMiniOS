<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Martel Magic Media Player - Enhanced</title>
  <style>
    body { 
      margin: 0; 
      height: 100vh; 
      overflow: hidden; 
      font-family: 'Arial', sans-serif;
    }

    #martel-magic-player {
      position: relative;
      height: 100%;
      background: radial-gradient(ellipse at center, #1a0033 0%, #2d0066 40%, #000 100%);
      animation: breathe 8s infinite ease-in-out;
    }

    @keyframes breathe {
      0%, 100% { background: radial-gradient(ellipse at center, #1a0033 0%, #2d0066 40%, #000 100%); }
      50% { background: radial-gradient(ellipse at center, #330066 0%, #1a0033 40%, #000 100%); }
    }

    /* Particle System */
    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: radial-gradient(circle, #00ffff, #ff69b4);
      border-radius: 50%;
      opacity: 0;
      animation: float-particle 6s infinite ease-in-out;
    }

    @keyframes float-particle {
      0% { opacity: 0; transform: translateY(100vh) scale(0); }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { opacity: 0; transform: translateY(-20vh) scale(1.5); }
    }

    /* Smoke Effect */
    #smoke-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
    }

    .smoke {
      position: absolute;
      width: 200px;
      height: 200px;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.1), transparent 70%);
      border-radius: 50%;
      animation: smoke-rise 12s infinite ease-out;
      filter: blur(3px);
    }

    @keyframes smoke-rise {
      0% { 
        opacity: 0.8;
        transform: translateY(100vh) scale(0.5) rotate(0deg);
      }
      50% {
        opacity: 0.4;
        transform: translateY(50vh) scale(1) rotate(180deg);
      }
      100% { 
        opacity: 0;
        transform: translateY(-10vh) scale(1.5) rotate(360deg);
      }
    }

    /* Enhanced Wave */
    #wave-overlay {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 25%;
      background: linear-gradient(45deg, #00cccc, #ff69b4, #9370db, #00ffff);
      background-size: 400% 400%;
      animation: wave-dance 4s infinite ease-in-out, gradient-shift 8s infinite;
      clip-path: polygon(0 50%, 10% 40%, 20% 60%, 30% 30%, 40% 70%, 50% 20%, 60% 80%, 70% 35%, 80% 65%, 90% 45%, 100% 55%, 100% 100%, 0% 100%);
    }

    @keyframes wave-dance {
      0%, 100% { transform: translateY(0) rotateX(0deg); }
      25% { transform: translateY(-15px) rotateX(5deg); }
      75% { transform: translateY(-25px) rotateX(-5deg); }
    }

    @keyframes gradient-shift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Playlist with Wings */
    #playlist {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      z-index: 10;
    }

    .candy-item {
      position: relative;
      display: inline-block;
      margin: 15px;
      padding: 20px 25px;
      background: linear-gradient(45deg, #ff69b4, #9370db, #00ffff);
      background-size: 200% 200%;
      border-radius: 25px;
      cursor: pointer;
      color: white;
      font-weight: bold;
      font-size: 14px;
      text-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
      box-shadow: 0 0 20px rgba(255, 105, 180, 0.6), inset 0 0 20px rgba(255, 255, 255, 0.2);
      animation: candy-float 4s infinite ease-in-out, candy-glow 3s infinite;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      overflow: hidden;
    }

    .candy-item::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, #ff69b4, #00ffff, #9370db, #ff69b4);
      background-size: 400% 400%;
      border-radius: 25px;
      z-index: -1;
      animation: border-flow 3s infinite linear;
    }

    .candy-item::after {
      content: 'âœ¨';
      position: absolute;
      top: -10px;
      right: -10px;
      font-size: 20px;
      animation: sparkle 2s infinite;
    }

    .candy-item:hover {
      transform: scale(1.1) translateY(-5px);
      box-shadow: 0 0 40px rgba(255, 105, 180, 0.9), inset 0 0 30px rgba(255, 255, 255, 0.3);
    }

    @keyframes candy-float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      33% { transform: translateY(-15px) rotate(2deg); }
      66% { transform: translateY(-10px) rotate(-2deg); }
    }

    @keyframes candy-glow {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    @keyframes border-flow {
      0% { background-position: 0% 50%; }
      100% { background-position: 400% 50%; }
    }

    @keyframes sparkle {
      0%, 100% { opacity: 1; transform: scale(1) rotate(0deg); }
      50% { opacity: 0.3; transform: scale(1.5) rotate(180deg); }
    }

    /* Enhanced Media Player */
    #media-player {
      position: absolute;
      top: 65%;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      z-index: 10;
    }

    #media-player video, #media-player audio, #media-player img {
      max-width: 80%;
      border-radius: 20px;
      box-shadow: 0 0 40px #ff69b4, 0 0 80px rgba(255, 105, 180, 0.4);
      animation: media-pulse 3s infinite ease-in-out;
      border: 3px solid transparent;
      background: linear-gradient(45deg, #ff69b4, #00ffff) padding-box, 
                  linear-gradient(45deg, #ff69b4, #9370db, #00ffff) border-box;
    }

    @keyframes media-pulse {
      0%, 100% { box-shadow: 0 0 40px #ff69b4, 0 0 80px rgba(255, 105, 180, 0.4); }
      50% { box-shadow: 0 0 60px #00ffff, 0 0 120px rgba(0, 255, 255, 0.6); }
    }

    /* Enhanced Upload Button */
    #upload-btn {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 15px 30px;
      background: linear-gradient(45deg, #9370db, #ff69b4, #00ffff);
      background-size: 200% 200%;
      color: white;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 0 20px rgba(147, 112, 219, 0.6);
      animation: button-glow 2s infinite;
      transition: transform 0.2s ease;
      z-index: 10;
    }

    #upload-btn:hover {
      transform: translateX(-50%) scale(1.05);
      box-shadow: 0 0 30px rgba(147, 112, 219, 0.9);
    }

    @keyframes button-glow {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* Wing Animation Elements */
    .wing {
      position: absolute;
      width: 150px;
      height: 75px;
      background: linear-gradient(45deg, rgba(255, 105, 180, 0.3), rgba(0, 255, 255, 0.3));
      border-radius: 50% 10% 50% 10%;
      animation: wing-flap 2s infinite ease-in-out;
    }

    .wing-left {
      left: -75px;
      top: 50%;
      transform-origin: right center;
    }

    .wing-right {
      right: -75px;
      top: 50%;
      transform-origin: left center;
      animation-delay: 0.1s;
    }

    @keyframes wing-flap {
      0%, 100% { transform: rotateY(0deg) rotateZ(0deg); opacity: 0.6; }
      50% { transform: rotateY(30deg) rotateZ(10deg); opacity: 1; }
    }

    /* Audio Visualization */
    #visualizer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 5;
    }
  </style>
</head>
<body>
  <div id="martel-magic-player">
    <!-- Particle System -->
    <div id="particle-container"></div>
    
    <!-- Smoke Effect -->
    <div id="smoke-container"></div>
    
    <!-- Enhanced Wave -->
    <div id="wave-overlay"></div>
    
    <!-- Audio Visualizer -->
    <canvas id="visualizer"></canvas>
    
    <!-- Upload Button -->
    <input type="file" id="upload-btn" accept="video/*,audio/*,image/*" multiple>
    
    <!-- Playlist -->
    <div id="playlist"></div>
    
    <!-- Media Player -->
    <div id="media-player">
      <video id="video-player" controls style="display:none;"></video>
      <audio id="audio-player" controls style="display:none;"></audio>
      <img id="image-player" style="display:none;">
    </div>
  </div>

  <script>
    const playlist = [];
    let currentIndex = 0;
    let audioContext, analyser, dataArray, source;

    // Initialize particle system
    function createParticles() {
      const particleContainer = document.getElementById('particle-container');
      for (let i = 0; i < 50; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 6 + 's';
        particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
        particleContainer.appendChild(particle);
      }
    }

    // Initialize smoke effect
    function createSmoke() {
      const smokeContainer = document.getElementById('smoke-container');
      for (let i = 0; i < 8; i++) {
        const smoke = document.createElement('div');
        smoke.className = 'smoke';
        smoke.style.left = Math.random() * 100 + '%';
        smoke.style.animationDelay = Math.random() * 12 + 's';
        smoke.style.animationDuration = (Math.random() * 8 + 8) + 's';
        smokeContainer.appendChild(smoke);
      }
    }

    // Audio visualization
    function setupAudioVisualization(audioElement) {
      if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioContext.createAnalyser();
        analyser.fftSize = 256;
        dataArray = new Uint8Array(analyser.frequencyBinCount);
      }

      if (source) {
        source.disconnect();
      }
      
      source = audioContext.createMediaElementSource(audioElement);
      source.connect(analyser);
      analyser.connect(audioContext.destination);
      
      drawVisualization();
    }

    function drawVisualization() {
      const canvas = document.getElementById('visualizer');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      function animate() {
        requestAnimationFrame(animate);
        analyser.getByteFrequencyData(dataArray);

        ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        const barWidth = (canvas.width / dataArray.length) * 2.5;
        let barHeight;
        let x = 0;

        for (let i = 0; i < dataArray.length; i++) {
          barHeight = (dataArray[i] / 255) * canvas.height * 0.8;

          const gradient = ctx.createLinearGradient(0, canvas.height - barHeight, 0, canvas.height);
          gradient.addColorStop(0, `hsl(${i * 2}, 100%, 70%)`);
          gradient.addColorStop(1, `hsl(${i * 2 + 60}, 100%, 50%)`);

          ctx.fillStyle = gradient;
          ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);

          x += barWidth + 1;
        }
      }

      animate();
    }

    // File upload handling
    document.getElementById('upload-btn').addEventListener('change', (e) => {
      const files = Array.from(e.target.files);
      files.forEach(file => {
        const item = document.createElement('div');
        item.className = 'candy-item';
        item.innerHTML = `
          <div class="wing wing-left"></div>
          <div class="wing wing-right"></div>
          ${file.name}
        `;
        item.addEventListener('click', () => playMedia(playlist.indexOf(file)));
        document.getElementById('playlist').appendChild(item);
        playlist.push(file);
      });
      if (playlist.length > 0) playMedia(0);
    });

    function playMedia(index) {
      currentIndex = index;
      const file = playlist[index];
      const videoPlayer = document.getElementById('video-player');
      const audioPlayer = document.getElementById('audio-player');
      const imagePlayer = document.getElementById('image-player');

      // Hide all players
      videoPlayer.style.display = 'none';
      audioPlayer.style.display = 'none';
      imagePlayer.style.display = 'none';

      const url = URL.createObjectURL(file);

      if (file.type.startsWith('image/')) {
        imagePlayer.src = url;
        imagePlayer.style.display = 'block';
        setTimeout(nextMedia, 10000);
      } else if (file.type.startsWith('video/')) {
        videoPlayer.src = url;
        videoPlayer.style.display = 'block';
        videoPlayer.play();
        videoPlayer.onended = nextMedia;
      } else if (file.type.startsWith('audio/')) {
        audioPlayer.src = url;
        audioPlayer.style.display = 'block';
        audioPlayer.play();
        audioPlayer.onended = nextMedia;
        
        // Setup audio visualization
        audioPlayer.onplay = () => {
          if (audioContext && audioContext.state === 'suspended') {
            audioContext.resume();
          }
          setupAudioVisualization(audioPlayer);
        };
      }

      // Update active playlist item
      document.querySelectorAll('.candy-item').forEach((item, i) => {
        if (i === index) {
          item.style.transform = 'scale(1.2) translateY(-10px)';
          item.style.boxShadow = '0 0 60px rgba(255, 105, 180, 1), inset 0 0 40px rgba(255, 255, 255, 0.4)';
        } else {
          item.style.transform = '';
          item.style.boxShadow = '';
        }
      });
    }

    function nextMedia() {
      if (playlist.length > 0) {
        currentIndex = (currentIndex + 1) % playlist.length;
        playMedia(currentIndex);
      }
    }

    // Initialize effects
    createParticles();
    createSmoke();

    // Keyboard controls
    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        if (playlist.length > 0) {
          const video = document.getElementById('video-player');
          const audio = document.getElementById('audio-player');
          if (video.style.display !== 'none') {
            video.paused ? video.play() : video.pause();
          } else if (audio.style.display !== 'none') {
            audio.paused ? audio.play() : audio.pause();
          }
        }
      } else if (e.code === 'ArrowRight') {
        nextMedia();
      } else if (e.code === 'ArrowLeft') {
        currentIndex = (currentIndex - 1 + playlist.length) % playlist.length;
        playMedia(currentIndex);
      }
    });

    console.log("ðŸŽµ Martel Magic Media Player Enhanced - Ready to Buzz! ðŸŽµ");
    console.log("âœ¨ Features: Particles, Smoke, Audio Visualization, Wings, and Magic! âœ¨");
  </script>
</body>
</html>
