<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0a0b0f" />
  <title>P.O.P.S. ‚Äî One-Pager Mini OS</title>
  <meta name="description" content="P.O.P.S. single-page flat UI OS with draggable panels, AppDock, and offline AppDrop catalog. Modular, resizable, and session-aware." />
  <style>
    html, body {
      margin: 0; padding: 0; font-family: 'Inter', sans-serif;
      background-color: #0a0b0f; color: #e2e8f0;
    }
    #hud {
      display: flex; justify-content: space-between; align-items: center;
      padding: 10px; background: #1a202c; border-bottom: 1px solid #2d3748;
    }
    .btn {
      padding: 6px 10px; margin-right: 6px; border: none; border-radius: 4px;
      background: #2b6cb0; color: white; cursor: pointer;
    }
    .btn.hl { background: #38b2ac; }
    .badge {
      padding: 2px 6px; background: #4a5568; border-radius: 4px; font-size: 12px;
    }
    .panel {
      position: absolute; width: 600px; top: 100px; left: 100px;
      background: #2d3748; border-radius: 6px; box-shadow: 0 0 8px rgba(0,0,0,0.5);
      resize: both; overflow: auto; z-index: 1; display: flex; flex-direction: column;
    }
    .panel.active { z-index: 10; }
    .p-head {
      background: #1a202c; padding: 10px; font-weight: bold; cursor: move;
      display: flex; justify-content: space-between; align-items: center;
    }
    .p-head .close {
      font-size: 14px; cursor: pointer; padding: 0 6px; color: #e53e3e;
    }
    .p-body {
      flex: 1; display: flex; flex-direction: column; height: 100%; padding: 0;
    }
    .urlbar {
      padding: 10px; background: #1a202c;
    }
    .urlbar input { width: 60%; }
    .urlbar button { margin-left: 4px; }
    .browser iframe, .p-body iframe {
      flex-grow: 1;
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }
    .kv { display: flex; gap: 8px; margin: 5px 10px; }
    .kv span { width: 80px; }
    .col { display: flex; flex-direction: column; gap: 8px; }
    .list {
      background: #1a202c; padding: 8px; max-height: 300px; overflow-y: auto;
      border: 1px solid #2d3748;
    }
    #dock {
      position: fixed; bottom: 0; left: 0; right: 0; background: #1a202c;
      padding: 6px; display: flex; gap: 6px; border-top: 1px solid #2d3748;
    }
    .dock-item {
      background: #2d3748; color: white; padding: 6px 10px;
      border-radius: 6px; cursor: pointer; font-size: 14px;
    }
    .appdrop { padding: 8px; margin: 4px 0; background: #4a5568; border-radius: 4px; cursor: pointer; }
  </style>
</head>
<body>
  <div id="hud">
    <div id="brand"><span>P.O.P.S. Mini OS</span><span class="badge">v1.0</span></div>
    <div id="actions">
      <button class="btn" onclick="showBrowser()">üåê Web Browser</button>
      <button class="btn" onclick="showCatalog()">üìö Catalog</button>
      <button class="btn" onclick="saveLayout()">üíæ Save Layout</button>
      <button class="btn" onclick="loadLayout()">üì• Load Layout</button>
      <span class="badge" id="cacheStat">cache: 0</span>
    </div>
  </div>

  <div class="panel" id="browserPanel" style="display:none" onmousedown="bringToFront(this)">
    <div class="p-head" onmousedown="startDrag(event, this.parentElement)">
      Web Browser <span class="close" onclick="this.closest('.panel').style.display='none'">√ó</span>
    </div>
    <div class="p-body browser">
      <div class="urlbar">
        <input type="text" value="https://charlesmack.github.io/pops-media-hub/" id="urlInput">
        <button class="btn" onclick="goToURL()">Go</button>
      </div>
      
        <iframe id="webFrame" src="https://charlesmack.github.io/pops-media-hub/"></iframe>
   
    </div>
  </div>

  <div class="panel" id="catalogPanel" style="display:flex" onmousedown="bringToFront(this)">
    <div class="p-head" onmousedown="startDrag(event, this.parentElement)">
      Scroll Catalog <span class="close" onclick="this.closest('.panel').style.display='none'">√ó</span>
    </div>
    <div class="p-body browser">
      <div class="kv"><span>Filter</span><input id="catFilter" type="text" placeholder="Search AppDrops..." /></div>
      <div class="list" id="catalogList"></div>
    </div>
  </div>

  <div id="dock"></div>

  <script>
    let highestZ = 1;
    function bringToFront(panel) {
      document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
      panel.style.zIndex = ++highestZ;
      panel.classList.add('active');
    }
    function startDrag(evt, panel) {
      evt.preventDefault(); bringToFront(panel);
      const rect = panel.getBoundingClientRect();
      const offsetX = evt.clientX - rect.left;
      const offsetY = evt.clientY - rect.top;
      function onMouseMove(e) {
        panel.style.left = `${e.clientX - offsetX}px`;
        panel.style.top = `${e.clientY - offsetY}px`;
      }
      function onMouseUp() {
        document.removeEventListener('mousemove', onMouseMove);
        document.removeEventListener('mouseup', onMouseUp);
      }
      document.addEventListener('mousemove', onMouseMove);
      document.addEventListener('mouseup', onMouseUp);
    }
    function goToURL() {
      const input = document.getElementById('urlInput');
      const iframe = document.getElementById('webFrame');
      const url = input.value.trim();
      iframe.src = url;
    }
    function showBrowser() {
      const panel = document.getElementById('browserPanel');
      panel.style.display = 'flex';
      bringToFront(panel);
    }
    function showCatalog() {
      const panel = document.getElementById('catalogPanel');
      panel.style.display = 'flex';
      bringToFront(panel);
    }
    function saveLayout() {
      const layout = Array.from(document.querySelectorAll('.panel')).map(panel => ({
        html: panel.innerHTML,
        left: panel.style.left,
        top: panel.style.top,
        width: panel.style.width,
        height: panel.style.height
      }));
      localStorage.setItem('popsLayout', JSON.stringify(layout));
      alert('Layout saved!');
    }
    function loadLayout() {
      const layout = JSON.parse(localStorage.getItem('popsLayout') || '[]');
      layout.forEach(({ html, left, top, width, height }) => {
        const panel = document.createElement('div');
        panel.className = 'panel';
        panel.innerHTML = html;
        panel.style.left = left;
        panel.style.top = top;
        panel.style.width = width;
        panel.style.height = height;
        panel.onmousedown = () => bringToFront(panel);
        panel.querySelector('.p-head')?.addEventListener('mousedown', (e) => startDrag(e, panel));
        document.body.appendChild(panel);
      });
    }
 function launchAppDrop(app) {
      const panel = document.createElement('div');
      panel.className = 'panel';
      const dock = document.getElementById('dock');
      const dockBtn = document.createElement('div');
      dockBtn.className = 'dock-item';
      dockBtn.textContent = app.name;
      dockBtn.onclick = () => bringToFront(panel);
      dock.appendChild(dockBtn);

      panel.innerHTML = `
        <div class="p-head" onmousedown="startDrag(event, this.parentElement)">
          ${app.name} <span class="close" onclick="this.closest('.panel').remove(); this.removeDockBtn()">√ó</span>
        </div>
        <div class="p-body">
          <iframe src="${app.entry}"></iframe>
        </div>`;

      panel.style.left = '120px';
      panel.style.top = `${100 + document.querySelectorAll('.panel').length * 60}px`;
      panel.onmousedown = () => bringToFront(panel);
      document.body.appendChild(panel);
      bringToFront(panel);

      panel.querySelector('.close').removeDockBtn = () => dock.removeChild(dockBtn);
    }
    function addToDock(name, panel) {
      const dock = document.getElementById('dock');
      const btn = document.createElement('div');
      btn.className = 'dock-item';
      btn.textContent = name;
      btn.onclick = () => bringToFront(panel);
      dock.appendChild(btn);
    }
    function loadCatalog() {
      const list = [
        { name: "P.O.P.S. Media Hub", version: "0.3.2", entry: "appdrops/pops/index.html", type: "iframe", description: "AI-driven music, video & art hub with leaderboard and voice control." },
        { name: "Offline Encyclopedia", version: "1.0.0", entry: "appdrops/encyclopedia/index.html", type: "iframe", description: "Browse curated offline articles, guides, and resources." },
        { name: "First Aid Guide", version: "1.0.0", entry: "appdrops/firstaid/index.html", type: "iframe", description: "Offline emergency and medical first aid reference app." },
        { name: "Pocket Encyclopedia", entry: "appdrops/encyclopedia/index.html", type: "iframe", description: "Lightweight version of the offline knowledge base." },
        { name: "Offline World Atlas", entry: "appdrops/atlas/index.html", type: "iframe", description: "Explore maps and geographic data offline." },
        { name: "Stakin' Mula ‚Äî Lite", entry: "appdrops/stakin-mula-lite/index.html", type: "iframe", description: "Offline runner game with minimal footprint." },
        { name: "Panel Pong", entry: "appdrops/panel-pong/index.html", type: "iframe", description: "Classic pong game inside a draggable panel." },
        { name: "Scratchpad", entry: "appdrops/scratchpad/index.html", type: "iframe", description: "Quick notes and ideas, stored offline." },
        { name: "Image Viewer", entry: "appdrops/image-viewer/index.html", type: "iframe", description: "Browse and preview offline images." },
        { name: "Planner Lite", entry: "appdrops/planner-lite/index.html", type: "iframe", description: "Simple calendar and task manager." },
        { name: "Procedural Art", entry: "appdrops/proc-art/index.html", type: "iframe", description: "Generate creative visuals using code." },
        { name: "Slangtionary Lite", entry: "appdrops/slangtionary/index.html", type: "iframe", description: "Offline urban dictionary for fun definitions." }
      ];
      const catList = document.getElementById('catalogList');
      catList.innerHTML = '';
      for (const app of list) {
        const div = document.createElement('div');
        div.className = 'appdrop';
        div.setAttribute('data-url', app.entry);
        div.setAttribute('data-type', app.type || 'iframe');
        div.innerHTML = `<strong>${app.name}</strong><br><small>${app.description}</small>`;
        div.onclick = () => launchAppDrop(app);
        catList.appendChild(div);
      }
    }
    document.getElementById('catFilter').addEventListener('input', function(e) {
      const filter = e.target.value.toLowerCase();
      document.querySelectorAll('.appdrop').forEach(el => {
        const text = el.textContent.toLowerCase();
        el.style.display = text.includes(filter) ? 'block' : 'none';
      });
    });
    loadCatalog();
  </script>
</body>
</html>
